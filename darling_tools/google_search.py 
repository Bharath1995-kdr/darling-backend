import os
import requests
from dotenv import load_dotenv

load_dotenv()

async def google_search(query: str) -> str:
    key = os.getenv("GOOGLE_SEARCH_API_KEY")
    cx = os.getenv("SEARCH_ENGINE_ID")
    url = f"https://www.googleapis.com/customsearch/v1"
    params = {
        "key": key,
        "cx": cx,
        "q": query,
        "num": 2
    }
    try:
        res = requests.get(url, params=params)
        items = res.json().get("items", [])
        if not items:
            return "‡≤Ø‡≤æ‡≤µ‡≥Å‡≤¶‡≥á ‡≤´‡≤≤‡≤ø‡≤§‡≤æ‡≤Ç‡≤∂ ‡≤∏‡≤ø‡≤ï‡≥ç‡≤ï‡≤ø‡≤≤‡≥ç‡≤≤ ü§∑‚Äç‚ôÇÔ∏è"
        result = ""
        for item in items:
            result += f"{item['title']}\n{item['link']}\n\n"
        return result.strip()
    except Exception as e:
        return f"‡≤∏‡≤∞‡≥ç‡≤ö‡≥ç ‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤¶‡≥ã‡≤∑: {e}"
